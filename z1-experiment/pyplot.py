data = [
[626,391,872,538],
[641,397,898,539],
[661,406,900,538],
[612,384,786,488],
[589,374,627,396],
[765,471,879,539],
[632,393,896,539],
[600,379,629,397],
[613,385,688,431],
[748,461,874,539],
[611,384,636,401],
[715,442,793,492],
[816,492,897,538],
[727,441,756,460],
[735,454,769,476],
[757,458,779,473],
[650,401,705,429],
[839,518,873,536],
[682,427,744,462],
[683,417,714,437],
[404,364,438,338],
[279,462,350,408],
[404,367,455,330],
[290,464,355,411],
[279,460,344,409],
[286,464,354,411],
[323,434,354,410],
[406,367,450,334],
[430,351,453,332],
[279,463,311,439],
[294,463,355,412],
[408,366,459,330],
[405,364,452,330],
[330,419,345,409],
[301,442,351,408],
[317,429,349,408],
[281,463,310,450],
[306,442,334,421],
[283,463,304,455],
[417,360,439,338],
[293,461,353,409],
[409,364,428,346],
[442,344,460,330],
[419,359,453,330],
[710,444,831,516],
[712,444,876,538],
[610,392,626,401],
[700,449,856,539],
[699,446,757,479],
[766,491,854,539],
[808,502,872,539],
[567,365,589,376],
[247,472,262,476],
[766,492,790,499],
[612,391,630,400],
[572,369,588,377],
[728,454,875,539],
[709,444,791,493],
[707,444,742,465],
[279,479,295,483],
[576,368,591,376],
[706,452,767,485],
[699,445,734,465],
[831,528,850,539],
[768,486,851,537],
[278,479,293,484],
[786,501,807,509],
[799,493,852,524],
[714,444,731,454],
[756,467,772,496],
[744,472,795,506],
[846,520,876,539],
[232,483,247,487],
[759,485,835,528],
[183,538,450,330],
[161,539,446,332],
[158,538,405,359],
[403,370,453,330],
[365,392,439,335],
[384,384,451,330],
[180,539,296,446],
[337,420,371,384],
[230,501,347,407],
[178,539,208,514],
[231,488,249,471],
[314,424,356,405],
[433,348,454,330],
[308,428,348,411],
[160,539,403,362],
[336,408,381,386],
[293,439,329,426],
[328,414,368,396],
[290,441,326,428],
[213,510,300,446],
[369,395,397,365],
[286,444,321,432],
[373,392,422,347],
[177,539,203,522],
[271,470,449,331],
[171,528,225,488],
[196,523,221,508],
[430,341,447,331],
[166,534,225,490],
[205,517,227,503],
[343,403,387,381],
[321,419,364,399],
[216,508,233,498],
]

import numpy as np
import matplotlib.pyplot as plt

def plot_point():
    d = np.array(data)
    xes = np.ndarray.flatten(d[:, 0::2])
    yes = np.ndarray.flatten(d[:, 1::2])

    plt.plot(xes, yes, 'ro')
    plt.show()

def plot_line():
    for n in range(0, len(data)):
        x1, y1, x2, y2 = data[n]
        print(data[n])
        plt.plot([x1, x2], [y1, y2], 'bs-')
    plt.show()

def average_line():
    plusLane = []
    plusSlope = []
    minusLane = []
    minusSlope = []
    plusXA = []
    plusYA = []
    minusXA = []
    minusYA = []
    for n in range(0, len(data)):
        x1, y1, x2, y2 = data[n]
        slope = (y2 - y1) / (x2 - x1)
        if slope > 0 and x1 > 500:
            plusSlope.append(slope)
            plusLane.append(n)
            plusXA.append((x2 - x1)/2 + x1)
            plusYA.append((y2 - y1)/2 + y1)
            plt.plot([x1, x2], [y1, y2], 'bs-')
        elif slope < 0 :
            minusSlope.append(slope)
            minusLane.append(n)
            minusXA.append((x2 - x1)/2 + x1)
            minusYA.append((y2 - y1)/2 + y1)
            plt.plot([x1, x2], [y1, y2], '*')

    print(plusSlope)
    avgPlusSlope = sum(plusSlope) / len(plusSlope)
    avgPlusXA = sum(plusXA) / len(plusXA)
    avgPlusYA = sum(plusYA) / len(plusYA)
    intercept = int(avgPlusYA - avgPlusSlope * avgPlusXA)
    plt.plot([0, 1000], [intercept, avgPlusSlope * 1000 + intercept], 'rs-')

    avgMinusSlope = sum(minusSlope) / len(minusSlope)
    avgMinusXA = sum(minusXA) / len(minusXA)
    avgMinusYA = sum(minusYA) / len(minusYA)
    intercept = int(avgMinusYA - avgMinusSlope * avgMinusXA)
    print(">", avgMinusXA, ", ", avgMinusYA, ", ", avgMinusSlope, ", ", intercept)
    plt.plot([0, 1000], [intercept, avgMinusSlope * 1000 + intercept], 'rs-')

    print(avgPlusSlope, ", ", avgMinusSlope)
    plt.show()


average_line()